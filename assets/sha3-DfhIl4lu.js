import{H,q as d,Q as T,R as x,S as _,k as O,t as X,a as m,T as F,w as U,U as E,V as P,W as j,X as M,Y as R,Z as C}from"./secp256k1-BHJWReMe.js";const I=[],b=[],L=[],W=BigInt(0),f=BigInt(1),q=BigInt(2),v=BigInt(7),z=BigInt(256),Q=BigInt(113);for(let n=0,t=f,s=1,i=0;n<24;n++){[s,i]=[i,(2*s+3*i)%5],I.push(2*(5*i+s)),b.push((n+1)*(n+2)/2%64);let o=W;for(let r=0;r<7;r++)t=(t<<f^(t>>v)*Q)%z,t&q&&(o^=f<<(f<<BigInt(r))-f);L.push(o)}const[V,Y]=E(L,!0),w=(n,t,s)=>s>32?P(n,t,s):j(n,t,s),y=(n,t,s)=>s>32?M(n,t,s):R(n,t,s);function g(n,t=24){const s=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let e=0;e<10;e++)s[e]=n[e]^n[e+10]^n[e+20]^n[e+30]^n[e+40];for(let e=0;e<10;e+=2){const h=(e+8)%10,u=(e+2)%10,p=s[u],a=s[u+1],S=w(p,a,1)^s[h],A=y(p,a,1)^s[h+1];for(let k=0;k<50;k+=10)n[e+k]^=S,n[e+k+1]^=A}let o=n[2],r=n[3];for(let e=0;e<24;e++){const h=b[e],u=w(o,r,h),p=y(o,r,h),a=I[e];o=n[a],r=n[a+1],n[a]=u,n[a+1]=p}for(let e=0;e<50;e+=10){for(let h=0;h<10;h++)s[h]=n[e+h];for(let h=0;h<10;h++)n[e+h]^=~s[(h+2)%10]&s[(h+4)%10]}n[0]^=V[i],n[1]^=Y[i]}s.fill(0)}class l extends H{constructor(t,s,i,o=!1,r=24){if(super(),this.blockLen=t,this.suffix=s,this.outputLen=i,this.enableXOF=o,this.rounds=r,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,d(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=T(this.state)}keccak(){x||_(this.state32),g(this.state32,this.rounds),x||_(this.state32),this.posOut=0,this.pos=0}update(t){O(this);const{blockLen:s,state:i}=this;t=X(t);const o=t.length;for(let r=0;r<o;){const e=Math.min(s-this.pos,o-r);for(let h=0;h<e;h++)i[this.pos++]^=t[r++];this.pos===s&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:s,pos:i,blockLen:o}=this;t[i]^=s,s&128&&i===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){O(this,!1),m(t),this.finish();const s=this.state,{blockLen:i}=this;for(let o=0,r=t.length;o<r;){this.posOut>=i&&this.keccak();const e=Math.min(i-this.posOut,r-o);t.set(s.subarray(this.posOut,this.posOut+e),o),this.posOut+=e,o+=e}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return d(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(F(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:s,suffix:i,outputLen:o,rounds:r,enableXOF:e}=this;return t||(t=new l(s,i,o,e,r)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=r,t.suffix=i,t.outputLen=o,t.enableXOF=e,t.destroyed=this.destroyed,t}}const c=(n,t,s)=>U(()=>new l(t,n,s)),Z=c(6,144,224/8),D=c(6,136,256/8),G=c(6,104,384/8),J=c(6,72,512/8),K=c(1,144,224/8),N=c(1,136,256/8),$=c(1,104,384/8),tt=c(1,72,512/8),B=(n,t,s)=>C((i={})=>new l(t,n,i.dkLen===void 0?s:i.dkLen,!0)),st=B(31,168,128/8),et=B(31,136,256/8),it=Object.freeze(Object.defineProperty({__proto__:null,Keccak:l,keccakP:g,keccak_224:K,keccak_256:N,keccak_384:$,keccak_512:tt,sha3_224:Z,sha3_256:D,sha3_384:G,sha3_512:J,shake128:st,shake256:et},Symbol.toStringTag,{value:"Module"}));export{it as a,N as k,D as s};
