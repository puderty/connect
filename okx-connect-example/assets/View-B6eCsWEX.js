import{C as y,p as N,s as A}from"./ConnectLayout-DoQGgMzj.js";import{d as w,a as c,_ as C,r as m,o as M,c as B,w as o,b as e,e as s,t as h,f}from"./index-B_XLZHpA.js";const V=w({props:{chainId:{type:String,required:!0},chainName:String},setup(n){var i;const t=n.chainId,d=c({}),b=c(""),g=T=>{d.value=JSON.parse(T)},P=c(""),a=c(""),l=c(15e-6),r=c(17100),u=c(""),p=c(""),v=((i=n.chainName)==null?void 0:i.toLowerCase())||"btc",I={btc:{chains:[t],defaultChain:t}};return{chainId:t,chainName:n.chainName,methodPrefix:v,chainNamespaces:I,currentMethod:P,transaction:d,transactionResult:b,setTransaction:g,nftId:a,receiver:p,psbtHex:u,sendAmount:l,sendSatoshisAmount:r,btcProvider:void 0}},components:{ConnectLayout:y},methods:{hexToBase64(n){for(var t=[],d=0;d<n.length;d+=2)t.push(parseInt(n.substr(d,2),16));const b=new Uint8Array(t),g=new Blob([b]);return new Promise((P,a)=>{const l=new FileReader;l.onload=function(r){var p;if((p=r.target)!=null&&p.result){var u=r.target.result.split(",")[1];P(u)}else a("Invalid result")},l.onerror=function(r){a(r)},l.readAsDataURL(g)})},signMessage(){this.transaction={from:"bc1p7pgnqe87red4cvd7ml6rh9pl9ufpr522k2y3dpeyrvfc6g2g3r3s3ae9dr",signStr:`Welcome to UniSat!

Click to sign in and accept the UniSat Terms of Service (https://unisat.io/terms-of-service.html) and Privacy Policy (https://unisat.io/privacy-policy.html).
    
This request will not trigger a blockchain transaction.
    
Your authentication status will reset after 24 hours.
    
Wallet address:
bc1p7pgnqe87red4cvd7ml6rh9pl9ufpr522k2y3dpeyrvfc6g2g3r3s3ae9dr
    
Nonce:
162d70e3-8c21-4cfd-9a22-9bf0a4b7be51
`},this.currentMethod=`${this.methodPrefix}_signMessage`},send(){if(this.sendAmount==0){alert("不能为零");return}this.transaction={from:"",to:"1NKnZ3uAuQLnmExA3WY44u1efwCgTiAxBn",value:`${this.sendAmount}`},this.currentMethod=`${this.methodPrefix}_send`},sendBitcoin(){if(this.sendAmount==0){alert("不能为零");return}this.transaction={from:"",toAddress:"1NKnZ3uAuQLnmExA3WY44u1efwCgTiAxBn",satoshis:this.sendSatoshisAmount,options:{feeRate:16}},this.currentMethod=`${this.methodPrefix}_sendBitcoin`},signPsbt_up(){if(!this.psbtHex){alert("请输入psbt");return}this.transaction={psbtHex:this.psbtHex,options:{autoFinalized:!1}},this.currentMethod=`${this.methodPrefix}_signPsbt`},signAndPushPsbt_up(){if(!this.psbtHex){alert("请输入psbt");return}this.transaction={psbtHex:this.psbtHex,options:{autoFinalized:!0}},this.currentMethod=`${this.methodPrefix}_signAndPushPsbt`},sendInscription(){if(!this.nftId){alert("请输入NFT ID");return}if(!this.receiver){alert("请输入接收者地址");return}this.transaction={address:this.receiver,inscriptionId:this.nftId,options:{feeRate:"15"}},this.currentMethod=`${this.methodPrefix}_sendInscription`},async sendTransaction(){if(!N.provider){alert("Please connect a wallet first");return}if(!this.transaction||!this.currentMethod){alert("Please select a transaction method first");return}this.btcProvider||(this.btcProvider=new A.OKXBtcProvider(N.provider));let n;if(this.currentMethod.endsWith("_signMessage")){const t=this.transaction;n=()=>this.btcProvider.signMessage(this.chainId,t.signStr)}else if(this.currentMethod.endsWith("_send"))n=()=>this.btcProvider.send(this.chainId,this.transaction);else if(this.currentMethod.endsWith("_signPsbt")){const t=this.transaction;n=()=>this.btcProvider.signPsbt(this.chainId,t.psbtHex,t.options).then(d=>this.hexToBase64(d))}else if(this.currentMethod.endsWith("_signPsbts")){const t=this.transaction;n=()=>this.btcProvider.signPsbts(this.chainId,t.psbtHexs,t.options)}else if(this.currentMethod.endsWith("_sendInscription")){const t=this.transaction;n=()=>this.btcProvider.sendInscription(this.chainId,t.address,t.inscriptionId,t.options)}else if(this.currentMethod.endsWith("_signAndPushPsbt")){const t=this.transaction;n=()=>this.btcProvider.signAndPushPsbt(this.chainId,t.psbtHex,t.options)}else if(this.currentMethod.endsWith("_sendBitcoin")){const t=this.transaction;n=()=>this.btcProvider.sendBitcoin(this.chainId,t.toAddress,t.satoshis,t.options)}else return;n().then(t=>{this.transactionResult=JSON.stringify(t)}).catch(t=>{this.transactionResult=JSON.stringify(t)})}}}),S={class:"subtitle-text",style:{"margin-top":"8px"}},$={class:"subtitle-text",style:{"margin-top":"8px"}};function k(n,t,d,b,g,P){const a=m("el-button"),l=m("el-divider"),r=m("el-input"),u=m("el-row"),p=m("el-col"),v=m("el-card"),I=m("ConnectLayout");return M(),B(I,{chainId:n.chainId,chainNamespaces:n.chainNamespaces,method:n.currentMethod,transaction:n.transaction,onEditTransaction:n.setTransaction,transactionResult:n.transactionResult,sendTransaction:n.sendTransaction},{default:o(()=>[e(v,null,{header:o(()=>[s("div",null,h(n.chainName||"BTC")+" methods",1),t[11]||(t[11]=s("ol",{class:"subtitle-text"},[s("li",null,"Click on the method's button to fill in the transaction information"),s("li",null,'Then, click "Send" after selecting a transaction')],-1))]),default:o(()=>[e(a,{type:"warning",onClick:t[0]||(t[0]=i=>n.signMessage())},{default:o(()=>[f(h(n.methodPrefix)+"_signMessage",1)]),_:1}),e(l),e(p,{span:24},{default:o(()=>[t[14]||(t[14]=s("p",{class:"subtitle-text"},"(发送到Pattern测试钱包的legacy地址)",-1)),e(u,null,{default:o(()=>[t[12]||(t[12]=s("p",null,"Send amount:",-1)),e(r,{modelValue:n.sendAmount,"onUpdate:modelValue":t[1]||(t[1]=i=>n.sendAmount=i),clearable:"",placeholder:"请输入要发送的数量"},null,8,["modelValue"])]),_:1}),e(a,{type:"warning",onClick:t[2]||(t[2]=i=>n.send())},{default:o(()=>[f(h(n.methodPrefix)+"_send",1)]),_:1}),e(l),e(u,null,{default:o(()=>[t[13]||(t[13]=s("p",null,"Send amount (in satoshis):",-1)),e(r,{modelValue:n.sendSatoshisAmount,"onUpdate:modelValue":t[3]||(t[3]=i=>n.sendSatoshisAmount=i),clearable:"",placeholder:"请输入要发送的satoshi数量"},null,8,["modelValue"])]),_:1}),e(a,{type:"warning",onClick:t[4]||(t[4]=i=>n.sendBitcoin())},{default:o(()=>[f(h(n.methodPrefix)+"_sendBitcoin",1)]),_:1})]),_:1}),e(l),e(p,{span:24},{default:o(()=>[e(u,null,{default:o(()=>[t[15]||(t[15]=s("p",null,"Psbt:",-1)),e(r,{modelValue:n.psbtHex,"onUpdate:modelValue":t[5]||(t[5]=i=>n.psbtHex=i),clearable:"",placeholder:"请输入要签名的Psbt"},null,8,["modelValue"])]),_:1}),e(a,{type:"warning",onClick:t[6]||(t[6]=i=>n.signPsbt_up())},{default:o(()=>[f(h(n.methodPrefix)+"_signPsbt(上架NFT)",1)]),_:1}),e(a,{type:"warning",onClick:t[7]||(t[7]=i=>n.signAndPushPsbt_up())},{default:o(()=>[f(h(n.methodPrefix)+"_signAndPushPsbt(上架NFT)",1)]),_:1}),s("ol",S,[s("li",null,"在OKX App选择要上架的 "+h(n.chainName||"BTC")+" NFT，点击【上架",1),t[16]||(t[16]=s("li",null,"弹出签名面板，点开高级选项，查看",-1)),t[17]||(t[17]=s("li",null,"单击复制，就可以得到psbt。然后退出上架流程。",-1)),t[18]||(t[18]=s("li",null,"验证 https://chainquery.com/bitcoin-cli/decodepsbt",-1))])]),_:1}),e(l),e(p,{span:24},{default:o(()=>[e(u,null,{default:o(()=>[t[19]||(t[19]=s("p",null,"NFT ID:",-1)),e(r,{modelValue:n.nftId,"onUpdate:modelValue":t[8]||(t[8]=i=>n.nftId=i),clearable:"",placeholder:"请输入要转移的NFT ID"},null,8,["modelValue"])]),_:1}),e(u,null,{default:o(()=>[t[20]||(t[20]=s("p",null,"Receiving address:",-1)),e(r,{modelValue:n.receiver,"onUpdate:modelValue":t[9]||(t[9]=i=>n.receiver=i),clearable:"",placeholder:"接收者钱包地址"},null,8,["modelValue"])]),_:1}),e(a,{type:"warning",onClick:t[10]||(t[10]=i=>n.sendInscription())},{default:o(()=>[f(h(n.methodPrefix)+"_sendInscription",1)]),_:1}),s("ol",$,[s("li",null,"在web端NFT界面，选择要发送的 "+h(n.chainName||"BTC")+" NFT，打开详情",1),t[21]||(t[21]=s("li",null,"从NFT详情页URL中获取NFT id（url最后一部分）",-1)),t[22]||(t[22]=s("li",null,"复制到上面输入框中，再点击sendInscription按钮",-1))])]),_:1})]),_:1})]),_:1},8,["chainId","chainNamespaces","method","transaction","onEditTransaction","transactionResult","sendTransaction"])}const R=C(V,[["render",k],["__scopeId","data-v-ef2e80b9"]]);export{R as B};
