import{x as Dt,y as Gt,F as It,z as it,A as Yt,B as Ut,C as Ot,D as nt,E as X,G as dt,I as Ht,J as Xt,K as Nt,L as Et,M as St,m as N,N as Mt,O,P as Wt}from"./secp256k1-BHJWReMe.js";const et=BigInt(2**32-1),ft=BigInt(32);function Lt(o,n=!1){return n?{h:Number(o&et),l:Number(o>>ft&et)}:{h:Number(o>>ft&et)|0,l:Number(o&et)|0}}function Vt(o,n=!1){let t=new Uint32Array(o.length),a=new Uint32Array(o.length);for(let d=0;d<o.length;d++){const{h:f,l:u}=Lt(o[d],n);[t[d],a[d]]=[f,u]}return[t,a]}const Kt=(o,n)=>BigInt(o>>>0)<<ft|BigInt(n>>>0),jt=(o,n,t)=>o>>>t,qt=(o,n,t)=>o<<32-t|n>>>t,kt=(o,n,t)=>o>>>t|n<<32-t,Jt=(o,n,t)=>o<<32-t|n>>>t,$t=(o,n,t)=>o<<64-t|n>>>t-32,Pt=(o,n,t)=>o>>>t-32|n<<64-t,Qt=(o,n)=>n,tn=(o,n)=>o,nn=(o,n,t)=>o<<t|n>>>32-t,sn=(o,n,t)=>n<<t|o>>>32-t,en=(o,n,t)=>n<<t-32|o>>>64-t,on=(o,n,t)=>o<<t-32|n>>>64-t;function cn(o,n,t,a){const d=(n>>>0)+(a>>>0);return{h:o+t+(d/2**32|0)|0,l:d|0}}const rn=(o,n,t)=>(o>>>0)+(n>>>0)+(t>>>0),an=(o,n,t,a)=>n+t+a+(o/2**32|0)|0,dn=(o,n,t,a)=>(o>>>0)+(n>>>0)+(t>>>0)+(a>>>0),fn=(o,n,t,a,d)=>n+t+a+d+(o/2**32|0)|0,hn=(o,n,t,a,d)=>(o>>>0)+(n>>>0)+(t>>>0)+(a>>>0)+(d>>>0),ln=(o,n,t,a,d,f)=>n+t+a+d+f+(o/2**32|0)|0,l={fromBig:Lt,split:Vt,toBig:Kt,shrSH:jt,shrSL:qt,rotrSH:kt,rotrSL:Jt,rotrBH:$t,rotrBL:Pt,rotr32H:Qt,rotr32L:tn,rotlSH:nn,rotlSL:sn,rotlBH:en,rotlBL:on,add:cn,add3L:rn,add3H:an,add4L:dn,add4H:fn,add5H:ln,add5L:hn},[xn,bn]=l.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(o=>BigInt(o))),K=new Uint32Array(80),j=new Uint32Array(80);class un extends Gt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:n,Al:t,Bh:a,Bl:d,Ch:f,Cl:u,Dh:p,Dl:g,Eh:A,El:e,Fh:m,Fl:w,Gh:L,Gl:_,Hh:S,Hl:R}=this;return[n,t,a,d,f,u,p,g,A,e,m,w,L,_,S,R]}set(n,t,a,d,f,u,p,g,A,e,m,w,L,_,S,R){this.Ah=n|0,this.Al=t|0,this.Bh=a|0,this.Bl=d|0,this.Ch=f|0,this.Cl=u|0,this.Dh=p|0,this.Dl=g|0,this.Eh=A|0,this.El=e|0,this.Fh=m|0,this.Fl=w|0,this.Gh=L|0,this.Gl=_|0,this.Hh=S|0,this.Hl=R|0}process(n,t){for(let c=0;c<16;c++,t+=4)K[c]=n.getUint32(t),j[c]=n.getUint32(t+=4);for(let c=16;c<80;c++){const T=K[c-15]|0,G=j[c-15]|0,W=l.rotrSH(T,G,1)^l.rotrSH(T,G,8)^l.shrSH(T,G,7),$=l.rotrSL(T,G,1)^l.rotrSL(T,G,8)^l.shrSL(T,G,7),v=K[c-2]|0,C=j[c-2]|0,P=l.rotrSH(v,C,19)^l.rotrBH(v,C,61)^l.shrSH(v,C,6),k=l.rotrSL(v,C,19)^l.rotrBL(v,C,61)^l.shrSL(v,C,6),Q=l.add4L($,k,j[c-7],j[c-16]),tt=l.add4H(Q,W,P,K[c-7],K[c-16]);K[c]=tt|0,j[c]=Q|0}let{Ah:a,Al:d,Bh:f,Bl:u,Ch:p,Cl:g,Dh:A,Dl:e,Eh:m,El:w,Fh:L,Fl:_,Gh:S,Gl:R,Hh:M,Hl:q}=this;for(let c=0;c<80;c++){const T=l.rotrSH(m,w,14)^l.rotrSH(m,w,18)^l.rotrBH(m,w,41),G=l.rotrSL(m,w,14)^l.rotrSL(m,w,18)^l.rotrBL(m,w,41),W=m&L^~m&S,$=w&_^~w&R,v=l.add5L(q,G,$,bn[c],j[c]),C=l.add5H(v,M,T,W,xn[c],K[c]),P=v|0,k=l.rotrSH(a,d,28)^l.rotrBH(a,d,34)^l.rotrBH(a,d,39),Q=l.rotrSL(a,d,28)^l.rotrBL(a,d,34)^l.rotrBL(a,d,39),tt=a&f^a&p^f&p,ct=d&u^d&g^u&g;M=S|0,q=R|0,S=L|0,R=_|0,L=m|0,_=w|0,{h:m,l:w}=l.add(A|0,e|0,C|0,P|0),A=p|0,e=g|0,p=f|0,g=u|0,f=a|0,u=d|0;const rt=l.add3L(P,Q,ct);a=l.add3H(rt,C,k,tt),d=rt|0}({h:a,l:d}=l.add(this.Ah|0,this.Al|0,a|0,d|0)),{h:f,l:u}=l.add(this.Bh|0,this.Bl|0,f|0,u|0),{h:p,l:g}=l.add(this.Ch|0,this.Cl|0,p|0,g|0),{h:A,l:e}=l.add(this.Dh|0,this.Dl|0,A|0,e|0),{h:m,l:w}=l.add(this.Eh|0,this.El|0,m|0,w|0),{h:L,l:_}=l.add(this.Fh|0,this.Fl|0,L|0,_|0),{h:S,l:R}=l.add(this.Gh|0,this.Gl|0,S|0,R|0),{h:M,l:q}=l.add(this.Hh|0,this.Hl|0,M|0,q|0),this.set(a,d,f,u,p,g,A,e,m,w,L,_,S,R,M,q)}roundClean(){K.fill(0),j.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Bn=Dt(()=>new un);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const D=BigInt(0),F=BigInt(1),ot=BigInt(2),yn=BigInt(8),mn={zip215:!0};function wn(o){const n=Yt(o);return Ut(o,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...n})}function pn(o){const n=wn(o),{Fp:t,n:a,prehash:d,hash:f,randomBytes:u,nByteLength:p,h:g}=n,A=ot<<BigInt(p*8)-F,e=t.create,m=It(n.n,n.nBitLength),w=n.uvRatio||((h,s)=>{try{return{isValid:!0,value:t.sqrt(h*t.inv(s))}}catch{return{isValid:!1,value:D}}}),L=n.adjustScalarBytes||(h=>h),_=n.domain||((h,s,r)=>{if(it("phflag",r),s.length||r)throw new Error("Contexts/pre-hash are not supported");return h});function S(h,s){nt("coordinate "+h,s,D,A)}function R(h){if(!(h instanceof c))throw new Error("ExtendedPoint expected")}const M=St((h,s)=>{const{ex:r,ey:i,ez:x}=h,b=h.is0();s==null&&(s=b?yn:t.inv(x));const B=e(r*s),H=e(i*s),y=e(x*s);if(b)return{x:D,y:F};if(y!==F)throw new Error("invZ was invalid");return{x:B,y:H}}),q=St(h=>{const{a:s,d:r}=n;if(h.is0())throw new Error("bad point: ZERO");const{ex:i,ey:x,ez:b,et:B}=h,H=e(i*i),y=e(x*x),E=e(b*b),I=e(E*E),Z=e(H*s),Y=e(E*e(Z+y)),U=e(I+e(r*e(H*y)));if(Y!==U)throw new Error("bad point: equation left != right (1)");const z=e(i*x),V=e(b*B);if(z!==V)throw new Error("bad point: equation left != right (2)");return!0});class c{constructor(s,r,i,x){this.ex=s,this.ey=r,this.ez=i,this.et=x,S("x",s),S("y",r),S("z",i),S("t",x),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(s){if(s instanceof c)throw new Error("extended point not allowed");const{x:r,y:i}=s||{};return S("x",r),S("y",i),new c(r,i,F,e(r*i))}static normalizeZ(s){const r=t.invertBatch(s.map(i=>i.ez));return s.map((i,x)=>i.toAffine(r[x])).map(c.fromAffine)}static msm(s,r){return Ot(c,m,s,r)}_setWindowSize(s){W.setWindowSize(this,s)}assertValidity(){q(this)}equals(s){R(s);const{ex:r,ey:i,ez:x}=this,{ex:b,ey:B,ez:H}=s,y=e(r*H),E=e(b*x),I=e(i*H),Z=e(B*x);return y===E&&I===Z}is0(){return this.equals(c.ZERO)}negate(){return new c(e(-this.ex),this.ey,this.ez,e(-this.et))}double(){const{a:s}=n,{ex:r,ey:i,ez:x}=this,b=e(r*r),B=e(i*i),H=e(ot*e(x*x)),y=e(s*b),E=r+i,I=e(e(E*E)-b-B),Z=y+B,Y=Z-H,U=y-B,z=e(I*Y),V=e(Z*U),J=e(I*U),st=e(Y*Z);return new c(z,V,st,J)}add(s){R(s);const{a:r,d:i}=n,{ex:x,ey:b,ez:B,et:H}=this,{ex:y,ey:E,ez:I,et:Z}=s;if(r===BigInt(-1)){const bt=e((b-x)*(E+y)),ut=e((b+x)*(E-y)),at=e(ut-bt);if(at===D)return this.double();const Bt=e(B*ot*Z),yt=e(H*ot*I),mt=yt+Bt,wt=ut+bt,pt=yt-Bt,Ft=e(mt*at),Tt=e(wt*pt),vt=e(mt*pt),zt=e(at*wt);return new c(Ft,Tt,zt,vt)}const Y=e(x*y),U=e(b*E),z=e(H*i*Z),V=e(B*I),J=e((x+b)*(y+E)-Y-U),st=V-z,lt=V+z,xt=e(U-r*Y),Rt=e(J*st),_t=e(lt*xt),Ct=e(J*xt),Zt=e(st*lt);return new c(Rt,_t,Zt,Ct)}subtract(s){return this.add(s.negate())}wNAF(s){return W.wNAFCached(this,s,c.normalizeZ)}multiply(s){const r=s;nt("scalar",r,F,a);const{p:i,f:x}=this.wNAF(r);return c.normalizeZ([i,x])[0]}multiplyUnsafe(s,r=c.ZERO){const i=s;return nt("scalar",i,D,a),i===D?G:this.is0()||i===F?this:W.wNAFCachedUnsafe(this,i,c.normalizeZ,r)}isSmallOrder(){return this.multiplyUnsafe(g).is0()}isTorsionFree(){return W.unsafeLadder(this,a).is0()}toAffine(s){return M(this,s)}clearCofactor(){const{h:s}=n;return s===F?this:this.multiplyUnsafe(s)}static fromHex(s,r=!1){const{d:i,a:x}=n,b=t.BYTES;s=X("pointHex",s,b),it("zip215",r);const B=s.slice(),H=s[b-1];B[b-1]=H&-129;const y=dt(B),E=r?A:t.ORDER;nt("pointHex.y",y,D,E);const I=e(y*y),Z=e(I-F),Y=e(i*I-x);let{isValid:U,value:z}=w(Z,Y);if(!U)throw new Error("Point.fromHex: invalid y coordinate");const V=(z&F)===F,J=(H&128)!==0;if(!r&&z===D&&J)throw new Error("Point.fromHex: x=0 and x_0=1");return J!==V&&(z=e(-z)),c.fromAffine({x:z,y})}static fromPrivateKey(s){return C(s).point}toRawBytes(){const{x:s,y:r}=this.toAffine(),i=Ht(r,t.BYTES);return i[i.length-1]|=s&F?128:0,i}toHex(){return Xt(this.toRawBytes())}}c.BASE=new c(n.Gx,n.Gy,F,e(n.Gx*n.Gy)),c.ZERO=new c(D,F,F,D);const{BASE:T,ZERO:G}=c,W=Nt(c,p*8);function $(h){return N(h,a)}function v(h){return $(dt(h))}function C(h){const s=t.BYTES;h=X("private key",h,s);const r=X("hashed private key",f(h),2*s),i=L(r.slice(0,s)),x=r.slice(s,2*s),b=v(i),B=T.multiply(b),H=B.toRawBytes();return{head:i,prefix:x,scalar:b,point:B,pointBytes:H}}function P(h){return C(h).pointBytes}function k(h=new Uint8Array,...s){const r=Et(...s);return v(f(_(r,X("context",h),!!d)))}function Q(h,s,r={}){h=X("message",h),d&&(h=d(h));const{prefix:i,scalar:x,pointBytes:b}=C(s),B=k(r.context,i,h),H=T.multiply(B).toRawBytes(),y=k(r.context,H,b,h),E=$(B+y*x);nt("signature.s",E,D,a);const I=Et(H,Ht(E,t.BYTES));return X("result",I,t.BYTES*2)}const tt=mn;function ct(h,s,r,i=tt){const{context:x,zip215:b}=i,B=t.BYTES;h=X("signature",h,2*B),s=X("message",s),r=X("publicKey",r,B),b!==void 0&&it("zip215",b),d&&(s=d(s));const H=dt(h.slice(B,2*B));let y,E,I;try{y=c.fromHex(r,b),E=c.fromHex(h.slice(0,B),b),I=T.multiplyUnsafe(H)}catch{return!1}if(!b&&y.isSmallOrder())return!1;const Z=k(x,E.toRawBytes(),y.toRawBytes(),s);return E.add(y.multiplyUnsafe(Z)).subtract(I).clearCofactor().equals(c.ZERO)}return T._setWindowSize(8),{CURVE:n,getPublicKey:P,sign:Q,verify:ct,ExtendedPoint:c,utils:{getExtendedPublicKey:C,randomPrivateKey:()=>u(t.BYTES),precompute(h=8,s=c.BASE){return s._setWindowSize(h),s.multiply(BigInt(3)),s}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ht=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),gt=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Hn=BigInt(1),At=BigInt(2);BigInt(3);const En=BigInt(5),Sn=BigInt(8);function gn(o){const n=BigInt(10),t=BigInt(20),a=BigInt(40),d=BigInt(80),f=ht,p=o*o%f*o%f,g=O(p,At,f)*p%f,A=O(g,Hn,f)*o%f,e=O(A,En,f)*A%f,m=O(e,n,f)*e%f,w=O(m,t,f)*m%f,L=O(w,a,f)*w%f,_=O(L,d,f)*L%f,S=O(_,d,f)*L%f,R=O(S,n,f)*e%f;return{pow_p_5_8:O(R,At,f)*o%f,b2:p}}function An(o){return o[0]&=248,o[31]&=127,o[31]|=64,o}function In(o,n){const t=ht,a=N(n*n*n,t),d=N(a*a*n,t),f=gn(o*d).pow_p_5_8;let u=N(o*a*f,t);const p=N(n*u*u,t),g=u,A=N(u*gt,t),e=p===o,m=p===N(-o,t),w=p===N(-o*gt,t);return e&&(u=g),(m||w)&&(u=A),Wt(u,t)&&(u=N(-u,t)),{isValid:e||m,value:u}}const Ln=It(ht,void 0,!0),Rn={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ln,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Sn,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Bn,randomBytes:Mt,adjustScalarBytes:An,uvRatio:In},Cn=pn(Rn);export{Cn as e};
